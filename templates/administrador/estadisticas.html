<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>EstadÃ­sticas de Pedidos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h2>ðŸ“Š Ventas mensuales</h2>
<canvas id="ventasChart"></canvas>

<h2>ðŸ“¦ Cantidad de productos vendidos por mes</h2>
<canvas id="productosChart"></canvas>

<script>
const meses = {{ meses | tojson }};
const totales = {{ totales | tojson }};
const productos = {{ productos | tojson }};
const promedios = {{ promedios | tojson }};
</script>

<h2>ðŸ“ˆ Promedio de venta por pedido</h2>
<canvas id="promedioChart"></canvas>

<script>
const meses = {{ meses | tojson }};
const totales = {{ totales | tojson }};
const cantidades = {{ cantidades | tojson }};
const promedios = {{ promedios | tojson }};
</script>

<script src="{{ url_for('static', filename='js/estadisticas.js') }}"></script>

</body>
</html>
<script>
    // Datos desde Flask
    const meses = {{ meses | tojson }};
    const totales = {{ totales | tojson }};
    const productos = {{ productos | tojson }};
    const promedios = {{ promedios | tojson }};

    // ðŸ“Š Total de ventas por mes
    new Chart(document.getElementById("ventasChart"), {
        type: "bar",
        data: {
            labels: meses,
            datasets: [{
                label: "Total vendido ($)",
                data: totales,
                backgroundColor: "#7db243",
                borderRadius: 6
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: true }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // ðŸ“¦ Cantidad de productos vendidos por mes
    new Chart(document.getElementById("productosChart"), {
        type: "line",
        data: {
            labels: meses,
            datasets: [{
                label: "Productos vendidos",
                data: productos,
                borderColor: "#1b8a3d",
                backgroundColor: "rgba(27, 138, 61, 0.15)",
                fill: true,
                tension: 0.3,
                pointRadius: 5,
                pointHoverRadius: 7
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: true }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0   // solo enteros
                    }
                }
            }
        }
    });

    // ðŸ“ˆ Promedio de venta por pedido
    new Chart(document.getElementById("promedioChart"), {
        type: "line",
        data: {
            labels: meses,
            datasets: [{
                label: "Promedio por pedido ($)",
                data: promedios,
                borderColor: "#ff9800",
                backgroundColor: "rgba(255, 152, 0, 0.15)",
                fill: true,
                tension: 0.3,
                pointRadius: 5,
                pointHoverRadius: 7
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: true }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>
